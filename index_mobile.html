<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#FF6B9D">
    <title>Valentine's Pixelated Cat Games</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Caveat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: fixed;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #FFF8F0 0%, #FFE8F0 50%, #FFD9E8 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(
                    0deg,
                    rgba(0, 0, 0, 0.03) 0px,
                    rgba(0, 0, 0, 0.03) 1px,
                    transparent 1px,
                    transparent 2px
                );
            pointer-events: none;
            z-index: 1;
        }

        .container {
            position: relative;
            z-index: 2;
            width: 100%;
            height: 100%;
            max-width: 1000px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        /* Game Screens */
        .screen {
            display: none;
            animation: fadeIn 0.6s ease-out;
            width: 100%;
            padding: 20px;
            text-align: center;
        }

        .screen.active {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Title Styles */
        .title {
            font-family: 'Press Start 2P', cursive;
            font-size: clamp(1.5rem, 8vw, 2.5rem);
            color: #C41E3A;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 3px 3px 0px rgba(0, 0, 0, 0.1);
            animation: pixelBounce 0.6s ease-out;
            line-height: 1.2;
        }

        @keyframes pixelBounce {
            0% {
                transform: scale(0.8) translateY(-20px);
                opacity: 0;
            }
            100% {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }

        .subtitle {
            font-size: clamp(1rem, 4vw, 1.2rem);
            color: #FF6B9D;
            text-align: center;
            margin-bottom: 20px;
            font-weight: 600;
        }

        /* Start Screen */
        .start-screen {
            text-align: center;
            width: 100%;
        }

        .cat-intro {
            font-size: clamp(3rem, 15vw, 5rem);
            margin: 20px 0;
            animation: catWave 2s ease-in-out infinite;
            display: block;
        }

        @keyframes catWave {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(2deg); }
        }

        .intro-text {
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            color: #666;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .start-button, .guess-button, .letter-button {
            background: linear-gradient(135deg, #FF6B9D, #FFB6D9);
            color: white;
            border: 3px solid #C41E3A;
            padding: clamp(12px, 3vw, 15px) clamp(30px, 8vw, 40px);
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            font-weight: 700;
            cursor: pointer;
            border-radius: 10px;
            margin-top: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 157, 0.4);
            font-family: 'Nunito', sans-serif;
            min-height: 44px;
            min-width: 44px;
            touch-action: manipulation;
            -webkit-appearance: none;
            appearance: none;
        }

        .start-button:active, .guess-button:active, .letter-button:active {
            transform: scale(0.95);
            box-shadow: 0 2px 8px rgba(255, 107, 157, 0.4);
        }

        .start-button:hover, .guess-button:hover, .letter-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 157, 0.6);
        }

        /* Game Screens */
        .game-container {
            background: rgba(255, 255, 255, 0.95);
            border: 4px solid #FF6B9D;
            border-radius: 15px;
            padding: clamp(20px, 5vw, 40px);
            width: 100%;
            max-width: 600px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        /* Input Fields */
        .guess-input {
            width: 100%;
            padding: clamp(10px, 2vw, 12px);
            font-size: clamp(1rem, 3vw, 1rem);
            border: 2px solid #FFB6D9;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Nunito', sans-serif;
            transition: border-color 0.3s ease;
            -webkit-appearance: none;
            appearance: none;
            min-height: 44px;
        }

        .guess-input:focus {
            outline: none;
            border-color: #FF6B9D;
            box-shadow: 0 0 10px rgba(255, 107, 157, 0.3);
        }

        .feedback {
            margin-top: 15px;
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            font-weight: 600;
            text-align: center;
            min-height: 30px;
        }

        .feedback.correct {
            color: #32CD32;
            animation: slideIn 0.5s ease-out;
        }

        .feedback.incorrect {
            color: #FF6347;
            animation: shake 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* Matching Hearts Game */
        .matching-game {
            position: relative;
            width: 100%;
            background: linear-gradient(180deg, #E8D5F2 0%, #FFF8F0 100%);
            border: 3px solid #FFB6D9;
            border-radius: 10px;
            margin: 20px 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .game-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(clamp(60px, 15vw, 80px), 1fr));
            gap: clamp(8px, 2vw, 12px);
            width: 100%;
        }

        .heart-card {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #FFB6D9, #FFD700);
            border: 3px solid #FF6B9D;
            border-radius: 8px;
            cursor: pointer;
            font-size: clamp(1.5rem, 4vw, 2rem);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            touch-action: manipulation;
            min-height: 60px;
            position: relative;
            transform-style: preserve-3d;
        }

        .heart-card.flipped {
            background: linear-gradient(135deg, #FF6B9D, #FFB6D9);
            transform: rotateY(180deg);
        }

        .heart-card.matched {
            background: linear-gradient(135deg, #32CD32, #90EE90);
            border-color: #32CD32;
            animation: matchPulse 0.6s ease-out;
        }

        .heart-card:active:not(.matched) {
            transform: scale(0.95);
        }

        @keyframes matchPulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }

        .game-stats {
            display: flex;
            justify-content: space-around;
            align-items: center;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            font-weight: 700;
            color: #FF6B9D;
            flex-wrap: wrap;
            gap: 10px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Letter Screen */
        .letter-container {
            background: linear-gradient(135deg, #FFF8F0 0%, #FFE8F0 100%);
            border: 4px solid #C41E3A;
            border-radius: 15px;
            padding: clamp(20px, 5vw, 40px);
            width: 100%;
            max-width: 700px;
            min-height: 300px;
            box-shadow: 0 10px 40px rgba(196, 30, 58, 0.2);
            position: relative;
            max-height: 70vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .letter-header {
            font-family: 'Caveat', cursive;
            font-size: clamp(1.5rem, 5vw, 2rem);
            color: #C41E3A;
            text-align: center;
            margin-bottom: 20px;
        }

        .letter-content {
            font-size: clamp(1rem, 3vw, 1.1rem);
            line-height: 1.8;
            color: #333;
            min-height: 150px;
            font-family: 'Caveat', cursive;
            text-align: center;
        }

        .letter-content.typing {
            border-right: 3px solid #FF6B9D;
            animation: blink 0.7s infinite;
        }

        @keyframes blink {
            0%, 49% { border-right-color: #FF6B9D; }
            50%, 100% { border-right-color: transparent; }
        }

        /* Gift Boxes Screen */
        .gifts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(clamp(120px, 25vw, 200px), 1fr));
            gap: clamp(15px, 4vw, 30px);
            width: 100%;
            max-width: 900px;
            margin-top: 30px;
            padding: 0 10px;
        }

        .gift-box {
            position: relative;
            cursor: pointer;
            animation: giftBounce 2s ease-in-out infinite;
            touch-action: manipulation;
        }

        .gift-box:nth-child(2) {
            animation-delay: 0.2s;
        }

        .gift-box:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes giftBounce {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(2deg); }
        }

        .cat-character {
            font-size: clamp(2.5rem, 12vw, 5rem);
            text-align: center;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        .gift-box:active .cat-character {
            transform: scale(1.1) rotate(5deg);
        }

        .cat-name {
            font-family: 'Press Start 2P', cursive;
            font-size: clamp(0.6rem, 2vw, 0.9rem);
            color: #FF6B9D;
            text-align: center;
            margin-bottom: 8px;
            line-height: 1.2;
        }

        .gift-label {
            background: linear-gradient(135deg, #FF6B9D, #FFB6D9);
            color: white;
            padding: clamp(8px, 2vw, 10px);
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            font-size: clamp(0.75rem, 2.5vw, 0.9rem);
            transition: all 0.3s ease;
        }

        .gift-box:active .gift-label {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(255, 107, 157, 0.4);
        }

        /* Gift Content Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease-out;
            padding: 10px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: clamp(20px, 5vw, 40px);
            width: 100%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.4s ease-out;
            position: relative;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            font-family: 'Press Start 2P', cursive;
            font-size: clamp(1rem, 4vw, 1.5rem);
            color: #C41E3A;
            margin-bottom: 20px;
            text-align: center;
            line-height: 1.3;
        }

        .modal-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #FF6B9D;
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
            -webkit-appearance: none;
            appearance: none;
            min-height: 44px;
            min-width: 44px;
        }

        .modal-close:active {
            background: #C41E3A;
            transform: rotate(90deg) scale(0.9);
        }

        /* Gallery */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(clamp(100px, 20vw, 150px), 1fr));
            gap: clamp(10px, 2vw, 15px);
            margin: 20px 0;
        }

        .gallery-item {
            position: relative;
            aspect-ratio: 1;
            background: linear-gradient(135deg, #FFB6D9, #E8D5F2);
            border: 3px solid #FF6B9D;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }

        .gallery-item:active {
            transform: scale(1.05) rotate(2deg);
            box-shadow: 0 4px 15px rgba(255, 107, 157, 0.4);
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .gallery-description {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: clamp(8px, 2vw, 10px);
            font-size: clamp(0.7rem, 2vw, 0.85rem);
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        .gallery-item:active .gallery-description {
            transform: translateY(0);
        }

        /* Music Player */
        .music-list {
            display: flex;
            flex-direction: column;
            gap: clamp(10px, 2vw, 15px);
            margin: 20px 0;
        }

        .music-item {
            background: linear-gradient(135deg, #FFB6D9, #E8D5F2);
            padding: clamp(12px, 3vw, 15px);
            border-radius: 8px;
            border: 2px solid #FF6B9D;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            touch-action: manipulation;
            min-height: 44px;
        }

        .music-item:active {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(255, 107, 157, 0.3);
        }

        .music-icon {
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            flex-shrink: 0;
        }

        .music-info {
            flex: 1;
            min-width: 0;
        }

        .music-title {
            font-weight: 700;
            color: #C41E3A;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            word-break: break-word;
        }

        .music-artist {
            font-size: clamp(0.75rem, 2vw, 0.9rem);
            color: #666;
        }

        /* Compliments */
        .compliment-text {
            background: linear-gradient(135deg, #FFE8F0, #E8D5F2);
            padding: clamp(15px, 3vw, 20px);
            border-radius: 10px;
            border-left: 4px solid #FF6B9D;
            margin: 12px 0;
            line-height: 1.8;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            color: #333;
            text-align: left;
        }

        /* Particle Effects */
        .particle {
            position: fixed;
            pointer-events: none;
            animation: particleFloat 2s ease-out forwards;
        }

        @keyframes particleFloat {
            0% {
                opacity: 1;
                transform: translate(0, 0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(var(--tx), var(--ty)) scale(0);
            }
        }

        /* Mobile Optimizations */
        @media (max-width: 480px) {
            .container {
                padding: 5px;
            }

            .screen {
                padding: 15px;
            }

            .game-container {
                padding: 20px;
            }

            .gifts-container {
                margin-top: 20px;
            }

            .letter-container {
                min-height: 250px;
            }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #FFE8F0;
        }

        ::-webkit-scrollbar-thumb {
            background: #FF6B9D;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #C41E3A;
        }

        /* Prevent zoom on input focus (iOS) */
        input, textarea, select {
            font-size: 16px !important;
        }

        /* Safe area support for notched devices */
        @supports (padding: max(0px)) {
            body {
                padding-left: max(10px, env(safe-area-inset-left));
                padding-right: max(10px, env(safe-area-inset-right));
                padding-top: max(10px, env(safe-area-inset-top));
                padding-bottom: max(10px, env(safe-area-inset-bottom));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Start Screen -->
        <div class="screen start-screen active">
            <h1 class="title">üíï VALENTINE üíï</h1>
            <p class="subtitle">Pixelated Cat Mini Games</p>
            <span class="cat-intro">üê±</span>
            <p class="intro-text">Let's play some games and celebrate our love!</p>
            <button class="start-button" onclick="startGame()">START GAME</button>
        </div>

        <!-- Guessing Couple Year Game -->
        <div class="screen" id="guessScreen">
            <div class="game-container">
                <h2 class="title">üíë GUESS OUR YEAR üíë</h2>
                <p class="subtitle">What year did we start dating?</p>
                <input type="number" class="guess-input" id="yearInput" placeholder="Enter year" inputmode="numeric">
                <button class="guess-button" onclick="checkYear()">SUBMIT</button>
                <div class="feedback" id="yearFeedback"></div>
                <button class="guess-button" onclick="nextGame()" style="margin-top: 15px; display: none;" id="nextYearBtn">NEXT GAME ‚Üí</button>
            </div>
        </div>

        <!-- Guessing First Day Game -->
        <div class="screen" id="firstDayScreen">
            <div class="game-container">
                <h2 class="title">üìÖ GUESS OUR DAY üìÖ</h2>
                <p class="subtitle">What date was our first day together?</p>
                <p style="font-size: clamp(0.8rem, 2.5vw, 0.9rem); color: #666; margin-bottom: 10px;">Format: MM/DD/YYYY</p>
                <input type="text" class="guess-input" id="dateInput" placeholder="MM/DD/YYYY" inputmode="numeric">
                <button class="guess-button" onclick="checkFirstDay()">SUBMIT</button>
                <div class="feedback" id="dateFeedback"></div>
                <button class="guess-button" onclick="nextGame()" style="margin-top: 15px; display: none;" id="nextDateBtn">NEXT GAME ‚Üí</button>
            </div>
        </div>

        <!-- Matching Hearts Game -->
        <div class="screen" id="craneScreen">
            <div class="game-container">
                <h2 class="title">üíó MATCH HEARTS üíó</h2>
                <p class="subtitle">Find all matching pairs!</p>
                <div class="matching-game" id="matchingGame">
                    <div class="game-grid" id="gameGrid"></div>
                    <div class="game-stats">
                        <div class="stat-item">Moves: <span id="moveCount">0</span></div>
                        <div class="stat-item">Matched: <span id="matchedCount">0</span>/6</div>
                    </div>
                </div>
                <button class="guess-button" onclick="nextGame()" style="margin-top: 15px; display: none;" id="nextCraneBtn">NEXT GAME ‚Üí</button>
            </div>
        </div>

        <!-- Letter Screen -->
        <div class="screen" id="letterScreen">
            <div class="letter-container">
                <div class="letter-header">My Dearest Love,</div>
                <div class="letter-content" id="letterContent"></div>
                <button class="letter-button" onclick="nextGame()" style="display: none;" id="nextLetterBtn">Open Your Gifts ‚Üí</button>
            </div>
        </div>

        <!-- Gifts Screen -->
        <div class="screen" id="giftsScreen">
            <h1 class="title">üéÅ YOUR GIFTS üéÅ</h1>
            <p class="subtitle">Tap each cat to see their gift!</p>
            <div class="gifts-container">
                <div class="gift-box" onclick="openGift('lalay')">
                    <div class="cat-character">üß°</div>
                    <div class="cat-name">LALAY</div>
                    <div class="gift-label">10 Pictures</div>
                </div>
                <div class="gift-box" onclick="openGift('chitchay')">
                    <div class="cat-character">ü©∂</div>
                    <div class="cat-name">CHITCHAY</div>
                    <div class="gift-label">Favorite Music</div>
                </div>
                <div class="gift-box" onclick="openGift('kikay')">
                    <div class="cat-character">üß°ü§é</div>
                    <div class="cat-name">KIKAY</div>
                    <div class="gift-label">Compliments</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Gift Content -->
    <div class="modal" id="giftModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeGift()">‚úï</button>
            <div class="modal-header" id="modalTitle"></div>
            <div id="modalBody"></div>
        </div>
    </div>

    <script>
        // ===== CONFIGURATION =====
        const COUPLE_YEAR = 2020; // Change this to your actual year
        const FIRST_DAY = "02/14/2020"; // Change this to your actual first day (MM/DD/YYYY)

        const LOVE_LETTER = `
            Every moment with you feels like a beautiful dream I never want to wake up from.
            Your smile brightens my darkest days, and your laughter is the sweetest music to my ears.
            I fall in love with you more and more each day, in the smallest moments and the biggest adventures.
            Thank you for being my best friend, my partner, and my greatest love.
            Forever yours, with all my heart. üíï
        `;

        // ===== GAME STATE =====
        let currentScreen = 0;
        let craneScore = 0;
        let isCraneInitialized = false;
        let touchStartX = 0;
        let touchStartY = 0;

        // ===== SCREEN MANAGEMENT =====
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            const screen = document.getElementById(screenId);
            if (screen) {
                screen.classList.add('active');
                // Scroll to top
                setTimeout(() => {
                    window.scrollTo(0, 0);
                }, 0);
            }
        }

        function startGame() {
            showScreen('guessScreen');
            createParticles(event);
            document.getElementById('yearInput').focus();
        }

        function nextGame() {
            const nextScreens = {
                'guessScreen': 'firstDayScreen',
                'firstDayScreen': 'craneScreen',
                'craneScreen': 'letterScreen',
                'letterScreen': 'giftsScreen'
            };

            for (let [current, next] of Object.entries(nextScreens)) {
                if (document.getElementById(current).classList.contains('active')) {
                    if (next === 'letterScreen') {
                        startLetter();
                    }
                    if (next === 'craneScreen' && !isCraneInitialized) {
                        setTimeout(() => initCraneGame(), 100);
                    }
                    showScreen(next);
                    createParticles(event);
                    break;
                }
            }
        }

        // ===== GUESSING GAME =====
        function checkYear() {
            const input = document.getElementById('yearInput');
            const feedback = document.getElementById('yearFeedback');
            const year = parseInt(input.value);

            if (!input.value) {
                feedback.textContent = '‚ùå Please enter a year!';
                feedback.classList.remove('correct');
                feedback.classList.add('incorrect');
                return;
            }

            if (year === COUPLE_YEAR) {
                feedback.textContent = '‚ú® CORRECT! ‚ú® That\'s our year!';
                feedback.classList.remove('incorrect');
                feedback.classList.add('correct');
                document.getElementById('nextYearBtn').style.display = 'block';
                createParticles(event);
            } else {
                feedback.textContent = year < COUPLE_YEAR ? 'üìà Try a later year!' : 'üìâ Try an earlier year!';
                feedback.classList.remove('correct');
                feedback.classList.add('incorrect');
            }
        }

        function checkFirstDay() {
            const input = document.getElementById('dateInput');
            const feedback = document.getElementById('dateFeedback');
            const date = input.value;

            if (!input.value) {
                feedback.textContent = '‚ùå Please enter a date!';
                feedback.classList.remove('correct');
                feedback.classList.add('incorrect');
                return;
            }

            if (date === FIRST_DAY) {
                feedback.textContent = '‚ú® CORRECT! ‚ú® That\'s our special day!';
                feedback.classList.remove('incorrect');
                feedback.classList.add('correct');
                document.getElementById('nextDateBtn').style.display = 'block';
                createParticles(event);
            } else {
                feedback.textContent = '‚ùå Not quite! Try again!';
                feedback.classList.remove('correct');
                feedback.classList.add('incorrect');
            }
        }

        // ===== MATCHING HEARTS GAME =====
        let gameState = {
            cards: [],
            flipped: [],
            matched: [],
            moves: 0,
            isChecking: false
        };

        const heartEmojis = ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíù', 'üíò'];

        function initCraneGame() {
            if (isCraneInitialized) return;
            isCraneInitialized = true;

            gameState = {
                cards: [],
                flipped: [],
                matched: [],
                moves: 0,
                isChecking: false
            };

            // Create pairs of hearts
            const pairs = [...heartEmojis, ...heartEmojis];
            gameState.cards = pairs.sort(() => Math.random() - 0.5);

            const gameGrid = document.getElementById('gameGrid');
            gameGrid.innerHTML = '';

            gameState.cards.forEach((emoji, index) => {
                const card = document.createElement('div');
                card.className = 'heart-card';
                card.dataset.index = index;
                card.dataset.emoji = emoji;
                card.textContent = 'üíù';
                card.onclick = () => flipCard(card, index);
                gameGrid.appendChild(card);
            });

            document.getElementById('moveCount').textContent = '0';
            document.getElementById('matchedCount').textContent = '0';
        }

        function flipCard(cardElement, index) {
            if (gameState.isChecking) return;
            if (gameState.flipped.includes(index)) return;
            if (gameState.matched.includes(index)) return;

            gameState.flipped.push(index);
            cardElement.classList.add('flipped');
            cardElement.textContent = gameState.cards[index];
            createParticles(event);

            if (gameState.flipped.length === 2) {
                gameState.isChecking = true;
                gameState.moves++;
                document.getElementById('moveCount').textContent = gameState.moves;

                setTimeout(() => {
                    checkMatch();
                }, 600);
            }
        }

        function checkMatch() {
            const [index1, index2] = gameState.flipped;
            const card1 = document.querySelector(`[data-index="${index1}"]`);
            const card2 = document.querySelector(`[data-index="${index2}"]`);

            if (gameState.cards[index1] === gameState.cards[index2]) {
                // Match found
                card1.classList.add('matched');
                card2.classList.add('matched');
                gameState.matched.push(index1, index2);
                document.getElementById('matchedCount').textContent = gameState.matched.length / 2;

                if (gameState.matched.length === gameState.cards.length) {
                    // Game won
                    setTimeout(() => {
                        document.getElementById('nextCraneBtn').style.display = 'block';
                    }, 500);
                }
            } else {
                // No match
                card1.classList.remove('flipped');
                card2.classList.remove('flipped');
                card1.textContent = 'üíù';
                card2.textContent = 'üíù';
            }

            gameState.flipped = [];
            gameState.isChecking = false;
        }

        // ===== LETTER SCREEN =====
        function startLetter() {
            const letterContent = document.getElementById('letterContent');
            letterContent.textContent = '';
            letterContent.classList.add('typing');

            let index = 0;
            const text = LOVE_LETTER.trim();

            function typeText() {
                if (index < text.length) {
                    letterContent.textContent += text[index];
                    index++;
                    setTimeout(typeText, 50);
                } else {
                    letterContent.classList.remove('typing');
                    document.getElementById('nextLetterBtn').style.display = 'block';
                }
            }

            typeText();
        }

        // ===== GIFT BOXES =====
        function openGift(catName) {
            const modal = document.getElementById('giftModal');
            const title = document.getElementById('modalTitle');
            const body = document.getElementById('modalBody');

            if (catName === 'lalay') {
                title.textContent = 'üß° LALAY - 10 PICTURES';
                body.innerHTML = `
                    <div class="gallery">
                        <div class="gallery-item">
                            <div style="background: linear-gradient(135deg, #FF6B9D, #FFB6D9); width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üì∏</div>
                            <div class="gallery-description">Our first date</div>
                        </div>
                        <div class="gallery-item">
                            <div style="background: linear-gradient(135deg, #FFB6D9, #E8D5F2); width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üåÖ</div>
                            <div class="gallery-description">Sunrise together</div>
                        </div>
                        <div class="gallery-item">
                            <div style="background: linear-gradient(135deg, #E8D5F2, #FFE8F0); width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üéÇ</div>
                            <div class="gallery-description">Your birthday</div>
                        </div>
                        <div class="gallery-item">
                            <div style="background: linear-gradient(135deg, #FFD700, #FFC700); width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üèñÔ∏è</div>
                            <div class="gallery-description">Beach vacation</div>
                        </div>
                        <div class="gallery-item">
                            <div style="background: linear-gradient(135deg, #FF6B9D, #FFB6D9); width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üéÑ</div>
                            <div class="gallery-description">First Christmas</div>
                        </div>
                        <div class="gallery-item">
                            <div style="background: linear-gradient(135deg, #FFB6D9, #E8D5F2); width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üåô</div>
                            <div class="gallery-description">Starry night</div>
                        </div>
                        <div class="gallery-item">
                            <div style="background: linear-gradient(135deg, #E8D5F2, #FFE8F0); width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üé≠</div>
                            <div class="gallery-description">Concert night</div>
                        </div>
                        <div class="gallery-item">
                            <div style="background: linear-gradient(135deg, #FFD700, #FFC700); width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üçΩÔ∏è</div>
                            <div class="gallery-description">Dinner date</div>
                        </div>
                        <div class="gallery-item">
                            <div style="background: linear-gradient(135deg, #FF6B9D, #FFB6D9); width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üöó</div>
                            <div class="gallery-description">Road trip</div>
                        </div>
                        <div class="gallery-item">
                            <div style="background: linear-gradient(135deg, #FFB6D9, #E8D5F2); width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üíï</div>
                            <div class="gallery-description">Forever with you</div>
                        </div>
                    </div>
                `;
            } else if (catName === 'chitchay') {
                title.textContent = 'ü©∂ CHITCHAY - FAVORITE MUSIC';
                body.innerHTML = `
                    <div class="music-list">
                        <div class="music-item">
                            <div class="music-icon">üéµ</div>
                            <div class="music-info">
                                <div class="music-title">Our Song</div>
                                <div class="music-artist">The Perfect Love Song</div>
                            </div>
                        </div>
                        <div class="music-item">
                            <div class="music-icon">üé∂</div>
                            <div class="music-info">
                                <div class="music-title">Thinking of You</div>
                                <div class="music-artist">When You're Away</div>
                            </div>
                        </div>
                        <div class="music-item">
                            <div class="music-icon">üéº</div>
                            <div class="music-info">
                                <div class="music-title">Forever Love</div>
                                <div class="music-artist">Our Eternity</div>
                            </div>
                        </div>
                        <div class="music-item">
                            <div class="music-icon">üéπ</div>
                            <div class="music-info">
                                <div class="music-title">Sunset Romance</div>
                                <div class="music-artist">Golden Hour</div>
                            </div>
                        </div>
                        <div class="music-item">
                            <div class="music-icon">üé∏</div>
                            <div class="music-info">
                                <div class="music-title">My Heart Belongs to You</div>
                                <div class="music-artist">Forever Yours</div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (catName === 'kikay') {
                title.textContent = 'üß°ü§é KIKAY - COMPLIMENTS';
                body.innerHTML = `
                    <div class="compliment-text">
                        üíï You are the most beautiful person I know, inside and out. Your kindness radiates from your smile and touches everyone around you.
                    </div>
                    <div class="compliment-text">
                        ‚ú® Your intelligence and creativity inspire me every single day. The way you think and solve problems amazes me.
                    </div>
                    <div class="compliment-text">
                        üíó You have the biggest heart and the most genuine compassion. You care deeply about the people you love.
                    </div>
                    <div class="compliment-text">
                        üåü Your sense of humor makes me laugh until my sides hurt. You bring so much joy and light into my life.
                    </div>
                    <div class="compliment-text">
                        üíï You are my safe place, my home, my everything. With you, I feel complete and truly loved.
                    </div>
                    <div class="compliment-text">
                        üéÄ Your strength and resilience inspire me to be a better person. You never give up on your dreams.
                    </div>
                    <div class="compliment-text">
                        üíñ The way you love is pure and unconditional. You make me feel like the luckiest person in the world.
                    </div>
                    <div class="compliment-text">
                        ‚ú® You are my greatest adventure and my favorite person. I want to spend forever with you.
                    </div>
                `;
            }

            modal.classList.add('active');
            createParticles(event);
        }

        function closeGift() {
            document.getElementById('giftModal').classList.remove('active');
        }

        // ===== PARTICLE EFFECTS =====
        function createParticles(event) {
            const particleCount = 12;
            const x = event?.clientX || window.innerWidth / 2;
            const y = event?.clientY || window.innerHeight / 2;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.textContent = ['üíï', '‚ú®', 'üíó', 'üåπ'][Math.floor(Math.random() * 4)];
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                particle.style.fontSize = (Math.random() * 15 + 8) + 'px';
                particle.style.setProperty('--tx', (Math.random() - 0.5) * 150 + 'px');
                particle.style.setProperty('--ty', (Math.random() - 0.5) * 150 - 80 + 'px');
                document.body.appendChild(particle);

                setTimeout(() => particle.remove(), 2000);
            }
        }

        // ===== EVENT LISTENERS =====
        document.addEventListener('DOMContentLoaded', () => {
            // Prevent double tap zoom
            document.addEventListener('touchend', (e) => {
                if (e.target.tagName !== 'INPUT') {
                    e.preventDefault();
                }
            }, false);

            // Enter key support for inputs
            document.getElementById('yearInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') checkYear();
            });
            document.getElementById('dateInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') checkFirstDay();
            });
        });

        // Close modal on background click
        document.getElementById('giftModal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('giftModal')) {
                closeGift();
            }
        });

        // Prevent default touch behaviors
        document.addEventListener('touchmove', (e) => {
            if (e.target.closest('.matching-game')) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>
